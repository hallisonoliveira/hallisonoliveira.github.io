<!DOCTYPE html> <html lang="pt-br"> <head> <link href="http://gmpg.org/xfn/11" rel="profile"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta http-equiv="content-type" content="text/html; charset=utf-8"> <!-- Enable responsiveness on mobile devices--> <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"> <title> O - Princípio Aberto/Fechado </title> <!-- CSS --> <link rel="stylesheet" href="/src/css/syntax.css"> <link rel="stylesheet" href="/src/css/lanyon.css"> <!-- Icons --> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png"> <link rel="shortcut icon" href="/assets/img/favicon.png"> <!-- RSS --> <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml"> <!-- Cards --> <link rel="stylesheet" href="/src/css/main.css"> <link rel="alternate" type="application/rss+xml" title="Hallison Oliveira" href="https://hallisonoliveira.com.br/feed.xml"> <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"> </head> <body> <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"> <!-- Toggleable sidebar --> <div class="sidebar" id="sidebar"> <div class="sidebar-item"> <h4 style="color: white; text-align: center">Hallison Oliveira</h4> </div> <div style="text-align: center"> <a href="https://www.linkedin.com/in/hallisonoliveira" style="margin-right: 8px"> <img src="/src/images/linkedin.png"/> </a> <a href="https://github.com/hallisonoliveira" style="margin-right: 15px"> <img src="/src/images/github.png"/> </a> <a href="https://twitter.com/hallisoncwb"> <img src="/src/images/twitter.png"/> </a> </div> <br /> <nav class="sidebar-nav"> <a class="sidebar-nav-item" href="/">Inicio</a> <a class="sidebar-nav-item" href="/posts">Posts</a> <a class="sidebar-nav-item" href="/about">Sobre</a> </nav> <div class="sidebar-item"> <p> &copy; 2025. Todos os direitos reservados. </p> </div> </div> <div class="wrap"> <div class="masthead"> <div class="container masthead-flex"> <h3 class="masthead-title"> <a href="/" title="Home">Hallison Oliveira</a> <small></small> </h3> <div class="language-switcher"> <a href="/en/posts/open_close_principle.html" class="lang-btn "> <img src="/assets/img/flags/us.svg" alt="English" class="flag-icon"> </a> </div> </div> </div> <div class="container"> <div class="wrapper"> <div class="row"> <div class="col-md-10"> <article class="page-post" itemscope itemtype="http://schema.org/BlogPosting"> <!-- Título do Post --> <h1 class="post-title" itemprop="name headline">O - Princípio Aberto/Fechado</h1> <!-- Categoria e Data --> <div class="post-meta"> <span class="post-category">SOLID</span> <span class="post-date"> <time datetime="2022-08-09T00:00:00-03:00" itemprop="datePublished">Aug 9, 2022</time> </span> </div> <!-- Imagem --> <div class="post-image"> <img src="/images/solid/open_close.png" alt="O - Princípio Aberto/Fechado" class="post-image-img"> </div> <!-- Conteúdo do Post --> <div class="post-content" itemprop="articleBody"> <p>Em inglês, <em>Open Closed Principle</em>.</p> <p>A definição desse princípio, segundo seu criador Bertrand Meyer, é a seguinte:</p> <blockquote> <p>Um artefato de software deve ser aberto para extensão, mas fechado para modificação.</p> </blockquote> <p>Ok, mas o que isso significa na prática?</p> <p>Decompondo um pouco essa definição, podemos dividi-la em duas partes:</p> <ul> <li>Aberto para extensão significa que um módulo pode ser alterado para receber novos atributos às suas estruturas de dados existentes ou então, novas funções podem ser adicionadas.</li> <li>Fechado para modificação significa que esse módulo específico já está bem definido e não há mais alteração alguma para fazer nele. Isso significa que ele está estável o suficiente para que outros módulos possam utilizá-lo.</li> </ul> <p>Tais definições parecem simples de entender. Porém, quando se trata de desenvolvimento de software, o cenário pode ser um tanto complexo, já que raramente um software é desenvolvido, concluído e não receberá mais modificações.</p> <p>No <em>post</em> em seu blog sobre esse princípio, Robert C. Martin cita uma nova definição:</p> <blockquote> <p>Você deve ser capaz de estender o comportamento de um sistema sem a necessidade de modificar tal sistema.</p> </blockquote> <p>Ou seja, durante o processo de desenvolvimento, devemos pensar nos módulos, classes, funções, etc, de uma forma que seja possível adicionar novos comportamentos à eles sem que o código já existente seja modificado. Isso traz extensão (aberto para extensão), mas mantém o que já existe inalterado, evitando que <em>bugs</em> ou novos comportamentos não mapeados sejam introduzidos às funcionalidades já existentes (fechado para modificação).</p> <h2 id="estudo-de-caso-logger">Estudo de caso: Logger</h2> <p>Imagine que temos uma aplicação qualquer que possui a necessidade de registrar alguns <em>logs</em> de seu funcionamento. De início, esses <em>logs</em> serão apresentados apenas no terminal onde o sistema está sendo executado. O código poderia ficar semelhante ao apresentado a seguir:</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">logger</span> <span class="p">=</span> <span class="nc">Logger</span><span class="p">()</span>

    <span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Log de debug"</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">Logger</span> <span class="p">{</span>
    <span class="k">fun</span> <span class="nf">debug</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Log de debug
</code></pre></div></div> <p>Agora, precisamos que a classe <code class="language-plaintext highlighter-rouge">Logger</code> registre os <em>logs</em> em arquivo também. Para isso, será necessário adicionar um parâmetro novo à implementação da classe e também será necessário fazer com que a função <code class="language-plaintext highlighter-rouge">debug(message: String)</code> envie o <em>log</em> para o arquivo. A implementação poderia ficar assim:</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">logger</span> <span class="p">=</span> <span class="nc">Logger</span><span class="p">()</span>

    <span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Log de debug"</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">Logger</span> <span class="p">{</span>

    <span class="k">private</span> <span class="kd">val</span> <span class="py">fileLogger</span> <span class="p">=</span> <span class="nc">FileLogger</span><span class="p">()</span>

    <span class="k">fun</span> <span class="nf">debug</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">fileLogger</span><span class="p">.</span><span class="nf">writeLogToFile</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">FileLogger</span> <span class="p">{</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">fileName</span> <span class="p">=</span> <span class="s">"/var/log/example.log"</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">logFile</span> <span class="p">=</span> <span class="nc">File</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span>

    <span class="k">fun</span> <span class="nf">writeLogToFile</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">logFile</span><span class="p">.</span><span class="nf">bufferedWriter</span><span class="p">().</span><span class="nf">use</span> <span class="p">{</span> <span class="k">out</span> <span class="p">-&gt;</span>
            <span class="k">out</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Perceba que foi necessário criar a classe <code class="language-plaintext highlighter-rouge">FileLogger</code> para fazer a gravação dos <em>logs</em> em arquivo e alterar a classe <code class="language-plaintext highlighter-rouge">Logger</code> já existente para fazer uso da nova classe.</p> <p>Foi preciso também alterar a função <code class="language-plaintext highlighter-rouge">debug(message: String)</code> para que ela chame a função <code class="language-plaintext highlighter-rouge">writeLogToFile(message: String)</code> da classe <code class="language-plaintext highlighter-rouge">FileLogger</code> e assim, efetuar a gravação da mensagem no arquivo.</p> <p>Nesse exemplo, pode-se ver claramente a quebra do Princípio Aberto/Fechado, pois foi necessário alterar implementações já existentes, como foi o caso da classe <code class="language-plaintext highlighter-rouge">Logger</code>, para que uma nova funcionalidade fosse adicionada. Ou seja, ela está aberta para extensão, mas não está fechada para alteração.</p> <p>Vejamos agora esse mesmo exemplo sem que esse princípio seja violado:</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">logger</span><span class="p">:</span> <span class="nc">Logger</span> <span class="p">=</span> <span class="nc">TerminalLogger</span><span class="p">()</span>

    <span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Log de debug"</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">interface</span> <span class="nc">Logger</span> <span class="p">{</span>
    <span class="k">fun</span> <span class="nf">debug</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">TerminalLogger</span> <span class="p">:</span> <span class="nc">Logger</span> <span class="p">{</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">debug</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Agora, temos a interface <code class="language-plaintext highlighter-rouge">Logger</code> que serve de contrato para qualquer tipo de <em>logger</em> que seja necessário no projeto. Assim, se precisarmos alterar a forma de registrar os <em>logs</em>, não será necessário alterar nenhuma implementação já existente, desde que os novos <em>loggers</em> sigam esse contrato.</p> <p>Para exibir os logs no terminal, criamos a classe <code class="language-plaintext highlighter-rouge">TerminalLogger</code>, que implementa a interface <code class="language-plaintext highlighter-rouge">Logger</code>, que será responsável por enviar as mensagens de <em>log</em> para o terminal.</p> <p>Para ilustrar o cenário onde seria necessário adicionar uma nova funcionalidade ao sistema, vamos trocar o <em>log</em> no terminal para <em>log</em> em arquivo, adicionando um novo <em>logger</em>.</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Trocamos TerminalLogger por FileLogger</span>
    <span class="kd">val</span> <span class="py">logger</span><span class="p">:</span> <span class="nc">Logger</span> <span class="p">=</span> <span class="nc">FileLogger</span><span class="p">()</span>

    <span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Log de debug"</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">interface</span> <span class="nc">Logger</span> <span class="p">{</span>
    <span class="k">fun</span> <span class="nf">debug</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// Não utilizado nesse exemplo</span>
<span class="kd">class</span> <span class="nc">TerminalLogger</span> <span class="p">:</span> <span class="nc">Logger</span> <span class="p">{</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">debug</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">FileLogger</span> <span class="p">:</span> <span class="nc">Logger</span> <span class="p">{</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">fileName</span> <span class="p">=</span> <span class="s">"/var/log/example.log"</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">logFile</span> <span class="p">=</span> <span class="nc">File</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">debug</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">logFile</span><span class="p">.</span><span class="nf">bufferedWriter</span><span class="p">().</span><span class="nf">use</span> <span class="p">{</span> <span class="k">out</span> <span class="p">-&gt;</span>
            <span class="k">out</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Perceba que a classe <code class="language-plaintext highlighter-rouge">FileLogger</code> também implementa a interface <code class="language-plaintext highlighter-rouge">Logger</code>, ou seja, ela também segue o mesmo contrato utilizado para a classe <code class="language-plaintext highlighter-rouge">TerminalLogger</code>. Isso quer dizer que, mesmo trocando <code class="language-plaintext highlighter-rouge">TerminalLogger</code> por <code class="language-plaintext highlighter-rouge">FileLogger</code> na função <code class="language-plaintext highlighter-rouge">main()</code>, o uso permanece o mesmo. Além disso, mantive a classe <code class="language-plaintext highlighter-rouge">TerminalLogger</code> no exemplo, mesmo ela não sendo utilizada, para mostrar que ela não precisou ser alterada.</p> <p>Agora, e se fosse necessário que os logs fossem registrados tanto no terminal, quanto em arquivo? Vejamos:</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">logger</span><span class="p">:</span> <span class="nc">Logger</span> <span class="p">=</span> <span class="nc">TerminalAndFileLogger</span><span class="p">()</span>

    <span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Log de debug"</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">interface</span> <span class="nc">Logger</span> <span class="p">{</span>
    <span class="k">fun</span> <span class="nf">debug</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">TerminalLogger</span> <span class="p">:</span> <span class="nc">Logger</span> <span class="p">{</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">debug</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">FileLogger</span> <span class="p">:</span> <span class="nc">Logger</span> <span class="p">{</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">fileName</span> <span class="p">=</span> <span class="s">"/var/log/example.log"</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">logFile</span> <span class="p">=</span> <span class="nc">File</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">debug</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">logFile</span><span class="p">.</span><span class="nf">bufferedWriter</span><span class="p">().</span><span class="nf">use</span> <span class="p">{</span> <span class="k">out</span> <span class="p">-&gt;</span>
            <span class="k">out</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">TerminalAndFileLogger</span> <span class="p">:</span> <span class="nc">Logger</span> <span class="p">{</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">terminalLogger</span> <span class="p">=</span> <span class="nc">TerminalLogger</span><span class="p">()</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">fileLogger</span> <span class="p">=</span> <span class="nc">FileLogger</span><span class="p">()</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">debug</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">terminalLogger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="n">fileLogger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Temos agora a classe <code class="language-plaintext highlighter-rouge">TerminalAndFileLogger</code> que, como o próprio nome mostra, será responsável por chamar <code class="language-plaintext highlighter-rouge">TerminalLogger</code> e <code class="language-plaintext highlighter-rouge">FileLogger</code> e ela também implementa a interface <code class="language-plaintext highlighter-rouge">Logger</code>, fazendo com que ela siga o mesmo contrato das demais.</p> <p>Essa forma de implementação fica interessante pois o uso de todos os <em>loggers</em> permanece o mesmo. Assim, a forma de chamá-la na função <code class="language-plaintext highlighter-rouge">main()</code> não mudou em relação às outras. Além disso, mesmo adicionando uma nova forma de registro de <em>logs</em> no sistema, terminal e arquivo juntos, o código dos demais loggers não foi alterado, mantendo eles fechados para alterações.</p> <h2 id="conclusão">Conclusão</h2> <p>Esse princípio é muito interessante e importante para o desenvolvimento de um sistema, pois tendo ele em mente, acabamos por estruturar o projeto de uma forma que facilite futuras implementações, reduzindo o esforço para adicionar uma nova funcionalidade ou até mesmo, alterar as funcionalidades já existentes. Além disso, tivemos oportunidade de aplicar herança e polimorfismo, dois conceitos muito importantes da Orientação à Objetos (logo teremos <em>posts</em> sobre eles).</p> <h2 id="referências">Referências</h2> <ul> <li>Arquitetura Limpa: O Guia do Artesão para Estrutura e Design de Software. Martin, Robert C. ; traduzido por Samantha Batista. Rio de Janeiro. Alta Books, 2018.</li> <li><a href="http://blog.cleancoder.com/uncle-bob/2014/05/12/TheOpenClosedPrinciple.html">The Open Closed Principle. Martin, Robert C. 12 de maio de 2014</a></li> </ul> </div> </article> <div class="row"> <ul class="pager"> <li><a class="previous" href="/posts/solid.html">&laquo; SOLID by example com Kotlin</a></li> </ul> </div> <!-- Seção de Comentários (Disqus) --> <div class="row"> <br/> Comente abaixo e dê seu feedback em relação ao post. <br/> <div id="disqus_thread"></div> <script> var disqus_config = function () { this.page.url = 'https://hallisonoliveira.com.br/posts/open_close_principle.html'; this.page.identifier = '/posts/open_close_principle.html'; }; (function () { var d = document, s = d.createElement('script'); s.src = 'https://hallisonoliveira.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> </div> </div> </div> </div> </div> </div> <label for="sidebar-checkbox" class="sidebar-toggle"></label> <script> (function(document) { var toggle = document.querySelector('.sidebar-toggle'); var sidebar = document.querySelector('#sidebar'); var checkbox = document.querySelector('#sidebar-checkbox'); document.addEventListener('click', function(e) { var target = e.target; if(!checkbox.checked || sidebar.contains(target) || (target === checkbox || target === toggle)) return; checkbox.checked = false; }, false); })(document); </script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script> <script src="/src/js/bootstrap.min.js"></script> </body> </html>
