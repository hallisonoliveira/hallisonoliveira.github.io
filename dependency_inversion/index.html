<!DOCTYPE html> <html lang="pt-br"> <head> <link href="http://gmpg.org/xfn/11" rel="profile"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta http-equiv="content-type" content="text/html; charset=utf-8"> <!-- Enable responsiveness on mobile devices--> <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"> <title> D - Princípio da Inversão de Dependência </title> <!-- CSS --> <link rel="stylesheet" href="/src/css/syntax.css"> <link rel="stylesheet" href="/src/css/lanyon.css"> <!-- Icons --> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png"> <link rel="shortcut icon" href="/assets/img/favicon.png"> <!-- RSS --> <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml"> <!-- Cards --> <link rel="stylesheet" href="/src/css/main.css"> <link rel="alternate" type="application/rss+xml" title="Hallison Oliveira" href="https://hallisonoliveira.com.br/feed.xml"> <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"> </head> <body> <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"> <!-- Toggleable sidebar --> <div class="sidebar" id="sidebar"> <div class="sidebar-item"> <h4 style="color: white; text-align: center">Hallison Oliveira</h4> </div> <div style="text-align: center"> <a href="https://www.linkedin.com/in/hallisonoliveira" style="margin-right: 8px"> <img src="/src/images/linkedin.png"/> </a> <a href="https://github.com/hallisonoliveira" style="margin-right: 15px"> <img src="/src/images/github.png"/> </a> <a href="https://twitter.com/hallisoncwb"> <img src="/src/images/twitter.png"/> </a> </div> <br /> <nav class="sidebar-nav"> <a class="sidebar-nav-item" href="/">Inicio</a> <a class="sidebar-nav-item" href="/posts">Posts</a> <a class="sidebar-nav-item" href="/about">Sobre</a> </nav> <div class="sidebar-item"> <p> &copy; 2025. Todos os direitos reservados. </p> </div> </div> <div class="wrap"> <div class="masthead"> <div class="container masthead-flex"> <h3 class="masthead-title"> <a href="/" title="Home">Hallison Oliveira</a> <small></small> </h3> <div class="language-switcher"> <a href="/en/dependency_inversion/" class="lang-btn "> <img src="/assets/img/flags/us.svg" alt="English" class="flag-icon"> </a> </div> </div> </div> <div class="container"> <div class="wrapper"> <div class="row"> <div class="col-md-10"> <article class="page-post" itemscope itemtype="http://schema.org/BlogPosting"> <!-- Título do Post --> <h1 class="post-title" itemprop="name headline">D - Princípio da Inversão de Dependência</h1> <!-- Categoria e Data --> <div class="post-meta"> <span class="post-category">SOLID</span> <span class="post-date"> <time datetime="2022-09-05T00:00:00-03:00" itemprop="datePublished">Sep 5, 2022</time> </span> </div> <!-- Imagem --> <div class="post-image"> <img src="/images/solid/dependency_inversion.png" alt="D - Princípio da Inversão de Dependência" class="post-image-img"> </div> <!-- Conteúdo do Post --> <div class="post-content" itemprop="articleBody"> <p>Em inglês, <em>Dependency Inversion Principle</em>.</p> <p>A ideia central desse princípio é a de que módulos não devem depender de implementações concretas, mas sim de abstrações. Esse é um dos conceitos centrais da arquitetura limpa, o qual protege a camada de domínio da aplicação de possuir dependências à bibliotecas e/ou frameworks externos dos quais ela não deveria possuir.</p> <p>Para entender melhor o princípio, vamos utilizar o exemplo de <em>Logger</em> novamente (já o utilizamos para demonstrar o <a href="/posts/open_close_principle.html">princípio aberto/fechado</a>).</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">logger</span> <span class="p">=</span> <span class="nc">TerminalLogger</span><span class="p">()</span>

    <span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Log de debug"</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">TerminalLogger</span> <span class="p">{</span>
    <span class="k">fun</span> <span class="nf">debug</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Com esse exemplo simples, já é possível visualizar a violação do princípio. Perceba que a variável <code class="language-plaintext highlighter-rouge">logger</code> é do tipo <code class="language-plaintext highlighter-rouge">TerminalLogger()</code>, que é uma implementação concreta. Ou seja, nossa função <code class="language-plaintext highlighter-rouge">main()</code>, que nesse exemplo representa qualquer outra classe, está suscetível à mudanças que eventualmente possam acontecer na classe <code class="language-plaintext highlighter-rouge">TerminalLogger()</code>. Podemos demonstrar isso fazendo com que a classe <code class="language-plaintext highlighter-rouge">TerminalLogger()</code> passe a depender de uma outra classe. Nesse caso, a função <code class="language-plaintext highlighter-rouge">main()</code> teria que conhecer essa nova classe para que uma nova instância de <code class="language-plaintext highlighter-rouge">TerminalLogger</code> possa ser criada:</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">systemProperties</span> <span class="p">=</span> <span class="nc">SystemProperties</span><span class="p">()</span>
    <span class="kd">val</span> <span class="py">logger</span> <span class="p">=</span> <span class="nc">TerminalLogger</span><span class="p">(</span><span class="n">systemProperties</span><span class="p">)</span>

    <span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Log de debug"</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">TerminalLogger</span><span class="p">(</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">systemProperties</span><span class="p">:</span> <span class="nc">SystemProperties</span>
<span class="p">)</span> <span class="p">{</span>
    <span class="k">fun</span> <span class="nf">debug</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">systemName</span> <span class="p">=</span> <span class="n">systemProperties</span><span class="p">.</span><span class="nf">getName</span><span class="p">()</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"$systemName - $message"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">SystemProperties</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">fun</span> <span class="nf">getName</span><span class="p">():</span> <span class="nc">String</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">"Exemplo-DIP"</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Agora, temos a classe <code class="language-plaintext highlighter-rouge">SystemProperties</code> que é responsável por fornecer o nome do sistema através da função <code class="language-plaintext highlighter-rouge">getName(): String</code>. O problema aqui é que, quem depende diretamente dela é a classe <code class="language-plaintext highlighter-rouge">TerminalLogger</code>. Porém, é a função <code class="language-plaintext highlighter-rouge">main()</code> quem deve instancia-la, fazendo com que a função conheça uma dependência de <code class="language-plaintext highlighter-rouge">TerminalLogger</code>, algo que está além da sua responsabilidade.</p> <p>Vejamos como esse exemplo ficaria, eliminando a violação desse princípio. O primeiro passo, é criar uma abstração (interface), para os <em>Loggers</em> e fazer com que a classe <code class="language-plaintext highlighter-rouge">TerminalLogger</code> a implemente:</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">interface</span> <span class="nc">Logger</span> <span class="p">{</span>

    <span class="k">fun</span> <span class="nf">debug</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">TerminalLogger</span><span class="p">(</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">systemProperties</span><span class="p">:</span> <span class="nc">SystemProperties</span>
<span class="p">)</span> <span class="p">:</span> <span class="nc">Logger</span> <span class="p">{</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">debug</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">systemName</span> <span class="p">=</span> <span class="n">systemProperties</span><span class="p">.</span><span class="nf">getName</span><span class="p">()</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"$systemName - $message"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Feito isso, precisamos de uma forma de criar uma nova instância da classe <code class="language-plaintext highlighter-rouge">TerminalLogger</code> sem que a função <code class="language-plaintext highlighter-rouge">main()</code> conheça suas dependências. Uma forma de fazer isso, é através de <a href="[https://pt.wikipedia.org/wiki/Injeção_de_dependência](https://pt.wikipedia.org/wiki/Inje%C3%A7%C3%A3o_de_depend%C3%AAncia)">injeção de dependência (que falaremos num outro post em breve)</a>, ou através de um <a href="[https://refactoring.guru/pt-br/design-patterns/abstract-factory](https://refactoring.guru/pt-br/design-patterns/abstract-factory)*"><em>design pattern</em></a>* chamado <a href="[https://refactoring.guru/pt-br/design-patterns/abstract-factory](https://refactoring.guru/pt-br/design-patterns/abstract-factory)"><em>Abstract Factory (fábrica abstrata)</em></a>.</p> <p>Esse <em>design pattern</em> especifica um formato que pode ser utilizado para criar e entregar as instâncias dos objetos que precisamos. Essa classe é responsável por conhecer as dependências necessárias para a criação das instâncias, evitando que essa responsabilidade fique nas classes onde não deveriam estar.</p> <p>Vejamos nosso exemplo, aplicando a interface <code class="language-plaintext highlighter-rouge">Logger</code>, juntamente com o <em>design pattern Abstract Factory</em>:</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>

    <span class="kd">val</span> <span class="py">loggerFactory</span> <span class="p">=</span> <span class="nc">LoggerFactory</span><span class="p">()</span>
    <span class="kd">val</span> <span class="py">logger</span> <span class="p">=</span> <span class="n">loggerFactory</span><span class="p">.</span><span class="nf">createTerminalLogger</span><span class="p">()</span>

    <span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Log de debug"</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">interface</span> <span class="nc">Logger</span> <span class="p">{</span>

    <span class="k">fun</span> <span class="nf">debug</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">TerminalLogger</span><span class="p">(</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">systemProperties</span><span class="p">:</span> <span class="nc">SystemProperties</span>
<span class="p">)</span> <span class="p">:</span> <span class="nc">Logger</span> <span class="p">{</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">debug</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">systemName</span> <span class="p">=</span> <span class="n">systemProperties</span><span class="p">.</span><span class="nf">getName</span><span class="p">()</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"$systemName - $message"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">SystemProperties</span><span class="p">()</span> <span class="p">{</span>

    <span class="k">fun</span> <span class="nf">getName</span><span class="p">():</span> <span class="nc">String</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">"Exemplo-DIP"</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">LoggerFactory</span><span class="p">()</span> <span class="p">{</span>

    <span class="k">private</span> <span class="kd">val</span> <span class="py">systemProperties</span> <span class="p">=</span> <span class="nc">SystemProperties</span><span class="p">()</span>

    <span class="k">fun</span> <span class="nf">createTerminalLogger</span><span class="p">():</span> <span class="nc">TerminalLogger</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">terminalLogger</span> <span class="p">=</span> <span class="nc">TerminalLogger</span><span class="p">(</span><span class="n">systemProperties</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">terminalLogger</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Agora, temos a classe <code class="language-plaintext highlighter-rouge">LoggerFactory</code> que é responsável por criar e retornar uma instância de <code class="language-plaintext highlighter-rouge">TerminalLogger</code> através da função <code class="language-plaintext highlighter-rouge">createTerminalLogger()</code>. Assim, a dependência pela classe <code class="language-plaintext highlighter-rouge">SystemProperties</code> fica na nossa classe <em>factory</em> e não mais na função <code class="language-plaintext highlighter-rouge">main()</code>.</p> <p>Essa solução pode deixar uma certa dúvida, já que a classe <code class="language-plaintext highlighter-rouge">LoggerFactory</code> depende de <code class="language-plaintext highlighter-rouge">SystemProperties</code>. Isso seria facilmente resolvido utilizando injeção de dependências, conforme citado anteriormente, mas como trata-se de um exemplo simples, essa solução é aceitável, pois apesar de a dependência ainda existir, ela está numa classe que faz mais sentido de estar. A classe <code class="language-plaintext highlighter-rouge">LoggerFactory</code> é responsável por criar a instância de <code class="language-plaintext highlighter-rouge">TerminalLogger</code> e, portanto, deve conhecer suas dependências, ao contrário da função <code class="language-plaintext highlighter-rouge">main()</code> que só precisa utilizar a classe <code class="language-plaintext highlighter-rouge">TerminalLogger</code>, não importando como ela funciona ou quais suas dependências.</p> <h2 id="conclusão">Conclusão</h2> <p>O Princípio da Inversão de Dependência é um princípio muito utilizado quando falamos de arquitetura limpa, que possui como premissa o uso de abstrações para redução do acoplamento entre as camadas. Podemos ver também que, mesmo que todas as abstrações sejam bem estruturadas, ainda terão casos onde os acoplamentos não serão removidos por completo, como a classe String do Java, citada por Robert C. Martin como exemplo aceitável de dependência direta à implementação.</p> <h2 id="referências">Referências</h2> <ul> <li>Arquitetura Limpa: O Guia do Artesão para Estrutura e Design de Software. Martin, Robert C. ; traduzido por Samantha Batista. Rio de Janeiro. Alta Books, 2018.</li> </ul> </div> </article> <div class="row"> <ul class="pager"> <li><a class="previous" href="/posts/solid.html">&laquo; SOLID by example com Kotlin</a></li> </ul> </div> <!-- Seção de Comentários (Disqus) --> <div class="row"> <br/> Comente abaixo e dê seu feedback em relação ao post. <br/> <div id="disqus_thread"></div> <script> var disqus_config = function () { this.page.url = 'https://hallisonoliveira.com.br/dependency_inversion/'; this.page.identifier = '/dependency_inversion/'; }; (function () { var d = document, s = d.createElement('script'); s.src = 'https://hallisonoliveira.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> </div> </div> </div> </div> </div> </div> <label for="sidebar-checkbox" class="sidebar-toggle"></label> <script> (function(document) { var toggle = document.querySelector('.sidebar-toggle'); var sidebar = document.querySelector('#sidebar'); var checkbox = document.querySelector('#sidebar-checkbox'); document.addEventListener('click', function(e) { var target = e.target; if(!checkbox.checked || sidebar.contains(target) || (target === checkbox || target === toggle)) return; checkbox.checked = false; }, false); })(document); </script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script> <script src="/src/js/bootstrap.min.js"></script> </body> </html>
